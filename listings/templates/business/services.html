{% extends '_business_update.html' %}
{% load static %}


{% block businessblock %}

<div class="relative px-4 block bg-white">
    <div class=" py-2  overflow-x-auto">
        <div class="relative flex flex-col w-full h-full text-gray-700 bg-white">
            <div class="relative mx-4 mt-4 overflow-hidden text-gray-700 bg-white rounded-none bg-clip-border">
                <div class="flex flex-col justify-between gap-8 mb-4 md:flex-row md:items-center">
                    <div class="flex items-center flex-wrap gap-7">
                        <div>
                            <h5
                                class="block font-sans text-xl antialiased font-semibold leading-snug tracking-normal text-blue-gray-900">
                                All Services offered by {{listing.title}}
                            </h5>
                            <p
                                class="block mt-1 font-sans text-base antialiased font-normal leading-relaxed text-gray-700">
                                These are details of all Services offered by {{listing.title}} listed
                            </p>
                        </div>
                        <div>
                            <a href="{% url 'markets:create-service' %}"
                                class="text-base font-normal px-3 py-2 border border-solid text-center">Add listing</a>
                        </div>
                    </div>

                    <div class="flex w-full gap-2 shrink-0 md:w-max">
                        <div class="w-full md:w-72">
                            <form method="get" action="{% url 'bbgi_home:all-listings' %}"
                                class="relative h-10 w-full min-w-[200px]">
                                <div
                                    class="absolute grid w-5 h-5 top-2/4 right-3 -translate-y-2/4 place-items-center text-customborder-custom-text0">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                        stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z">
                                        </path>
                                    </svg>
                                </div>
                                <input name="query"
                                    class="peer h-full w-full rounded-[7px] border border-blue-gray-200 border-t-transparent bg-transparent px-3 py-2.5 !pr-9 font-sans text-sm font-normal text-blue-gray-700 outline outline-0 transition-all placeholder-shown:border placeholder-shown:border-blue-gray-200 placeholder-shown:border-t-blue-gray-200 focus:border-2 focus:border-gray-900 focus:border-t-transparent focus:outline-0 disabled:border-0 disabled:bg-customborder-custom-text"
                                    placeholder=" " />
                                <label
                                    class="before:content[' '] after:content[' '] pointer-events-none absolute left-0 -top-1.5 flex h-full w-full select-none !overflow-visible truncate text-[11px] font-normal leading-tight text-gray-500 transition-all before:pointer-events-none before:mt-[6.5px] before:mr-1 before:box-border before:block before:h-1.5 before:w-2.5 before:rounded-tl-md before:border-t before:border-l before:border-blue-gray-200 before:transition-all after:pointer-events-none after:mt-[6.5px] after:ml-1 after:box-border after:block after:h-1.5 after:w-2.5 after:flex-grow after:rounded-tr-md after:border-t after:border-r after:border-blue-gray-200 after:transition-all peer-placeholder-shown:text-sm peer-placeholder-shown:leading-[3.75] peer-placeholder-shown:text-customborder-custom-text0 peer-placeholder-shown:before:border-transparent peer-placeholder-shown:after:border-transparent peer-focus:text-[11px] peer-focus:leading-tight peer-focus:text-gray-900 peer-focus:before:border-t-2 peer-focus:before:border-l-2 peer-focus:before:!border-gray-900 peer-focus:after:border-t-2 peer-focus:after:border-r-2 peer-focus:after:!border-gray-900 peer-disabled:text-transparent peer-disabled:before:border-transparent peer-disabled:after:border-transparent peer-disabled:peer-placeholder-shown:text-customborder-custom-text0">
                                    Search
                                </label>
                            </form>
                        </div>

                    </div>
                </div>
            </div>
            <div class="p-6 px-0 overflow-x-auto">
                <table class="w-full text-left table-auto min-w-max">
                    <thead>
                        <tr>
                            <th class="p-4 border-y border-blue-gray-100 bg-customborder-custom-text/50">
                                <p
                                    class="block font-sans text-sm antialiased font-normal leading-none text-blue-gray-900 opacity-70">
                                    Title
                                </p>
                            </th>


                            <th class="p-4 border-y border-blue-gray-100 bg-customborder-custom-text/50">
                                <p
                                    class="block font-sans text-sm antialiased font-normal leading-none text-blue-gray-900 opacity-70">
                                    Qoutations
                                </p>
                            </th>
                            <th class="p-4 border-y border-blue-gray-100 bg-customborder-custom-text/50">
                                <p
                                    class="block font-sans text-sm antialiased font-normal leading-none text-blue-gray-900 opacity-70">
                                    Status
                                </p>
                            </th>
                            <th class="p-4 border-y border-blue-gray-100 bg-customborder-custom-text/50">
                                <p
                                    class="block font-sans text-sm antialiased font-normal leading-none text-blue-gray-900 opacity-70">
                                    Date
                                </p>
                            </th>

                            <th class="p-4 border-y border-blue-gray-100 bg-customborder-custom-text/50">
                                <p
                                    class="block font-sans text-sm antialiased font-normal leading-none text-blue-gray-900 opacity-70">
                                    Author
                                </p>
                            </th>
                            <th class="p-4 border-y border-blue-gray-100 bg-customborder-custom-text/50">
                                <p
                                    class="block font-sans text-sm antialiased font-normal leading-none text-blue-gray-900 opacity-70">
                                </p>
                            </th>


                        </tr>
                    </thead>
                    <tbody>
                        {% for listing in listings %}
                        <tr>
                            <td class="p-4 border-b border-custom-text">

                                <a href="" class="flex items-center gap-3">
                                    {% if listing.logo %}
                                    <img src="{{listing.logo.url}}" alt="{{listing.title}}"
                                        class="relative inline-block h-12 w-12 !rounded-full bg-custom-primary object-cover object-center" />
                                    {% else %}
                                    <img src="{% static 'images/global/no-image-available.webp' %}"
                                        alt="{{listing.title}}"
                                        class="relative inline-block h-12 w-12 !rounded-full object-cover object-center" />
                                    {% endif %}
                                    <p
                                        class="block font-sans text-sm antialiased font-bold leading-normal text-blue-gray-900">


                                        {{listing.title|truncatewords:4}}
                                    </p>
                                </a>
                            </td>

                            <td class="p-4 border-b border-custom-text">
                                <p
                                    class="block font-sans text-sm antialiased font-normal leading-normal text-blue-gray-900">
                                    {{listing.category.label}}
                                </p>
                            </td>
                            <td class="p-4 border-b border-custom-text">
                                <div class="w-max">
                                    <div
                                        class="relative grid items-center px-2 py-1 font-sans text-xs font-bold {% if listing.status == 'APPROVED' %} bg-green-500/20 text-green-900{% elif listing.status == 'PENDING' %}bg-amber-500/20 text-amber-900 {% else %}bg-red-500/20 text-red-900{% endif %}  uppercase rounded-md select-none whitespace-nowrap ">
                                        <span class="">{{listing.status}}</span>
                                    </div>
                                </div>
                            </td>
                            <td class="p-4 border-b border-custom-text">
                                <p
                                    class="block font-sans text-sm antialiased font-normal leading-normal text-blue-gray-900">
                                    {{listing.created}}
                                </p>
                            </td>
                            <td class="p-4 border-b border-custom-text">
                                <div class="flex items-center gap-3">
                                    <a href="{% url 'accounts:user-details' username=listing.owner.username %}"
                                        class="w-12 p-1 border rounded-md h-9 border-custom-text">
                                        {% if listing.owner.profile_image %}
                                        <img src="{{listing.owner.profile_image.url}}"
                                            alt="{{listing.owner.get_full_name}}"
                                            class="relative inline-block h-full w-full !rounded-none  object-contain object-center p-1" />
                                        {% else %}
                                        <img src="{% static 'images/global/no-image-available.webp' %}"
                                            alt="{{listing.owner.get_full_name}}"
                                            class="relative inline-block h-full w-full !rounded-none  object-contain object-center p-1" />
                                        {% endif %}
                                    </a>
                                    <div class="flex flex-col">
                                        <p
                                            class="block font-sans text-sm antialiased font-normal leading-normal capitalize text-blue-gray-900">
                                            {{listing.owner.get_full_name}}
                                        </p>
                                        <p
                                            class="block font-sans text-sm antialiased font-normal leading-normal text-blue-gray-900 opacity-70">
                                            {{listing.owner.username}}
                                        </p>
                                    </div>
                                </div>
                            </td>
                            <td class="p-4 border-b border-custom-text space-x-8">
                                <a href="{% url 'listings:update-listing' listing.id %}"
                                    class="relative h-10 max-h-[40px] w-10 max-w-[40px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                                    type="button">
                                    <span class="">
                                        <i class="fa-solid fa-plus text-xl"></i>
                                    </span>
                                </a>

                                <a href="{% url 'listings:delete-listing' listing.id %}"
                                    class="relative h-10 max-h-[40px] w-10 max-w-[40px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                                    type="button">
                                    <span class="">
                                        <i class="fa-solid text-red-600 fa-trash text-xl"></i>

                                    </span>
                                </a>

                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="hidden items-center justify-between p-4 border-t border-custom-text">
                <button
                    class="select-none rounded-lg border border-gray-900 py-2 px-4 text-center align-middle font-sans text-xs font-bold uppercase text-gray-900 transition-all hover:opacity-75 focus:ring focus:ring-gray-300 active:opacity-[0.85] disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                    type="button">
                    Previous
                </button>
                <div class="flex items-center gap-2">
                    <button
                        class="relative h-8 max-h-[32px] w-8 max-w-[32px] select-none rounded-lg border border-gray-900 text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:opacity-75 focus:ring focus:ring-gray-300 active:opacity-[0.85] disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                        type="button">
                        <span class="absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2">
                            1
                        </span>
                    </button>
                    <button
                        class="relative h-8 max-h-[32px] w-8 max-w-[32px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                        type="button">
                        <span class="absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2">
                            2
                        </span>
                    </button>
                    <button
                        class="relative h-8 max-h-[32px] w-8 max-w-[32px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                        type="button">
                        <span class="absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2">
                            3
                        </span>
                    </button>
                    <button
                        class="relative h-8 max-h-[32px] w-8 max-w-[32px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                        type="button">
                        <span class="absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2">
                            ...
                        </span>
                    </button>
                    <button
                        class="relative h-8 max-h-[32px] w-8 max-w-[32px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                        type="button">
                        <span class="absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2">
                            8
                        </span>
                    </button>
                    <button
                        class="relative h-8 max-h-[32px] w-8 max-w-[32px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                        type="button">
                        <span class="absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2">
                            9
                        </span>
                    </button>
                    <button
                        class="relative h-8 max-h-[32px] w-8 max-w-[32px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                        type="button">
                        <span class="absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2">
                            10
                        </span>
                    </button>
                </div>
                <button
                    class="select-none rounded-lg border border-gray-900 py-2 px-4 text-center align-middle font-sans text-xs font-bold uppercase text-gray-900 transition-all hover:opacity-75 focus:ring focus:ring-gray-300 active:opacity-[0.85] disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                    type="button">
                    Next
                </button>
            </div>
        </div>
    </div>
</div>

{% endblock businessblock %}
{% block js %}
<script>

    const background_image_picker = document.querySelector("#id_background_image")
    const pick_background_image = document.querySelector("#pick_background_image")
    const no_background_image = document.querySelector("#no_background_image");
    const logo_picker = document.querySelector("#id_logo")
    const pick_logo = document.querySelector("#pick_logo")
    const no_logo = document.querySelector("#no_logo");
    const img_container_1 = document.querySelector("#img_container_1")
    const img_1 = document.querySelector("#img_1")
    const img_container_2 = document.querySelector("#img_container_2")
    const img_2 = document.querySelector("#img_2")
    const checkboxes = document.querySelectorAll(".checkboxes")

    if (img_container_1.getAttribute("data-background-image")) {

        img_container_1.innerHTML = '';
        img_container_1.innerHTML += `
                    <img
                        src="${img_container_1.getAttribute("data-background-image")}"
                        alt="{{request.user.first_name}}"
                        class="w-full h-full object-cover"
                        id="img_1"
                    />
                `
    }
    pick_background_image.addEventListener('click', () => {
        background_image_picker.click()
    })

    background_image_picker.onchange = ({target}) => {

        var file = target.files[0]

        if (file) {
            // console.log(no_background_image)
            if (no_background_image) {

                img_container_1.innerHTML = '';
                img_container_1.innerHTML += `
                    <img
                        src="${window.URL.createObjectURL(file)}"
                        alt="{{request.user.first_name}}"
                        class="w-full h-full object-cover"
                        id="img_1"
                    />
                `
            } else {
                img_1.src = window.URL.createObjectURL(file)
            }

        } else {
            alert("no file selected")
        }

    };

    if (img_container_2.getAttribute("data-logo")) {

        img_container_2.removeChild(no_logo);
        img_container_2.innerHTML += `
                    <img
                        src="${img_container_2.getAttribute("data-logo")}"
                        alt="{{request.user.first_name}}"
                        class="w-full h-full object-cover"
                        id="img_2"
                    />
                `
    }
    pick_logo.addEventListener('click', () => {
        logo_picker.click()
    })

    logo_picker.onchange = ({target}) => {

        var file = target.files[0]
        if (file) {
            // console.log(no_background_image)
            if (no_logo) {

                img_container_2.removeChild(no_logo);
                img_container_2.innerHTML += `
                    <img
                        src="${window.URL.createObjectURL(file)}"
                        alt="{{request.user.first_name}}"
                        class="w-full h-full object-cover"
                        id="img_2"
                    />
                `
            } else {
                img_2.src = window.URL.createObjectURL(file)
            }

        } else {
            alert("no file selected")
        }

    };

    // Monitor change in check boxes
    function toddleCheckboxes(e) {

        let target_element = e.target
        const container = document.querySelector(`#${target_element.getAttribute("data-container")}`)
        if (target_element.value === "on") {
            target_element.value = "off"
            container.classList.add("pointer-events-none")
        } else {
            target_element.value = "on"
            container.classList.remove("pointer-events-none")
        }
        if (target_element.value === "off") {
            target_element.value = "on"
            container.classList.remove("pointer-events-none")
        } else {
            target_element.value = "off"
            container.classList.add("pointer-events-none")
        }

    };

</script>
<script onerror="mapApiErrorHandler">
    "use strict";
    const coordinatesInput = document.getElementById('id_map_coordinates');
    const latitude = -33.918861;
    const longitude = 18.423300;
    if (coordinatesInput) {
        const coordinates = coordinatesInput.value.split(',');
        latitude = parseFloat(coordinates[0]);
        longitude = parseFloat(coordinates[1]);
    }


    function mapApiErrorHandler() {
        document.getElementById("id_address_one").disabled = false;
        alert("Error encountered trying to load map for your address")
    }

    function initMap() {
        try {
            const CONFIGURATION = {
                ctaTitle: "Checkout",
                mapOptions: {
                    center: {lat: latitude, lng: longitude},
                    fullscreenControl: true,
                    mapTypeControl: false,
                    streetViewControl: true,
                    zoom: 11,
                    zoomControl: true,
                    maxZoom: 22,
                    mapId: ""
                },
                capabilities: {
                    addressAutocompleteControl: true,
                    mapDisplayControl: true,
                    ctaControl: true
                }
            };

            const componentForm = [
                'location',
                'locality',
                'administrative_area_level_1',
                'country',
                'postal_code',
            ];


            const autocompleteInput = document.getElementById('id_address_one');
            const provinceInput = document.getElementById('id_province');
            const mapCoordinates = document.getElementById('id_map_coordinates');
            const cityInput = document.getElementById('id_city');
            const zipcodeInput = document.getElementById('id_zipcode');
            const addressTwoInput = document.getElementById('id_address_two');

            let map;
            try {
                map = new google.maps.Map(document.getElementById("gmp-map-listing"), {
                    zoom: CONFIGURATION.mapOptions.zoom,
                    center: CONFIGURATION.mapOptions.center,
                    mapTypeControl: CONFIGURATION.mapOptions.mapTypeControl,
                    fullscreenControl: CONFIGURATION.mapOptions.fullscreenControl,
                    zoomControl: CONFIGURATION.mapOptions.zoomControl,
                    streetViewControl: CONFIGURATION.mapOptions.streetViewControl
                });
            } catch (error) {
                console.error("Error loading Google Maps API:", error);
                alert("Error loading Google Maps. Please try again later.");

                return;
            }

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    position => {
                        const clientLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        map.setCenter(clientLocation);
                        const marker = new google.maps.Marker({position: clientLocation, map: map, draggable: false});
                        const geocoder = new google.maps.Geocoder();
                        geocoder.geocode({location: clientLocation}, (results, status) => {
                            if (status === 'OK' && results[0]) {
                                fillInAddress(results[0]);
                            } else {
                                alert("Sorry, we couldn't find address suggestion for your current location.");
                            }
                        });
                    },
                    error => {
                        console.error("Error getting geolocation:", error);
                        alert("Error getting your location. Please check your browser settings and try again.");
                    }
                );
            } else {
                alert("Geolocation is not supported by this browser.");
            }

            const marker = new google.maps.Marker({map: map, draggable: false});
            google.maps.event.addListener(map, 'click', (event) => {
                marker.setPosition(event.latLng);
                const geocoder = new google.maps.Geocoder();
                geocoder.geocode({location: event.latLng}, (results, status) => {
                    if (status === 'OK' && results[0]) {
                        fillInAddress(results[0]);
                    } else {
                        alert("Sorry, we couldn't find address suggestions for your location.");
                    }
                });
            });
            try {
                const autocomplete = new google.maps.places.Autocomplete(autocompleteInput, {
                    fields: ["place_id", "address_components", "geometry", "name"],
                    types: ["address"],
                });

                autocomplete.setComponentRestrictions({'country': ['za']});

                autocomplete.addListener('place_changed', () => {
                    const place = autocomplete.getPlace();
                    if (!place.geometry) {
                        alert(`No details available for input: '${place.name}'`);
                        return;
                    }
                    renderAddress(place);
                    fillInAddress(place);
                });

                function fillInAddress(place) {
                    const addressNameFormat = {
                        'street_number': 'short_name',
                        'route': 'long_name',
                        'locality': 'long_name',
                        'administrative_area_level_1': 'short_name',
                        'country': 'long_name',
                        'postal_code': 'short_name',
                    };

                    const getAddressComp = (type) => {
                        for (const component of place.address_components) {
                            if (component.types[0] === type) {
                                return component[addressNameFormat[type]];
                            }
                        }
                        return '';
                    };

                    autocompleteInput.value = getAddressComp('route');
                    addressTwoInput.value = getAddressComp('street_number');
                    provinceInput.value = getAddressComp('administrative_area_level_1');
                    cityInput.value = getAddressComp('locality');
                    zipcodeInput.value = getAddressComp('postal_code');
                    const latitude = place.geometry.location.lat();
                    const longitude = place.geometry.location.lng();
                    if (latitude && longitude) {
                        mapCoordinates.value = `${latitude},${longitude}`;
                    }
                }

                function renderAddress(place) {
                    map.setCenter(place.geometry.location);
                    marker.setPosition(place.geometry.location);
                    marker.setVisible(true);
                }

            } catch (error) {
                mapApiErrorHandler()
            }


        } catch (error) {
            mapApiErrorHandler()
        }
    }

    window.gm_authFailure = () => {
        mapApiErrorHandler()
    }
</script>
{% if request.user.is_authenticated %}
<script>
    const business_hours_container = document.querySelector("#business_hours_container")
    function get_hours() {
        $.ajax({
            type: "GET",
            url: $("#business_hours_container").data("hours-url"),
            contentType: "application/json; charset=utf-8",
            cache: false,
            success: function (data) {
                const DAYCHOICES = {
                    "MO": "Monday",
                    "TU": "Tuesday",
                    "WE": "Wednesday",
                    "TH": "Thursday",
                    "FR": "Friday",
                    "SA": "Saturday",
                    "SU": "Sunday"
                }

                if (data.success) {
                    let hours = JSON.parse(data.hours);

                    business_hours_container.innerHTML = ''
                    hours.forEach((hour, index) => {
                        let checked = hour.fields.operating ? "checked" : "";
                        let pointer_event = hour.fields.operating ? "" : "pointer-events-none";
                        let day = DAYCHOICES[hour.fields.day]

                        business_hours_container.innerHTML += `
                            <div class="flex flex-wrap items-center w-full rounded-md border border-solid justify-between gap-4 bg-white p-2">
                                    <div>
                                        <input id="id_form-${index}-day" type="text" name="form-${index}-day" value="${hour.fields.day}" class="w-[0.1px] h-[0.1px] opacity-0 overflow-hidden absolute -z-[1]">
                                        <p class="text-xl font-normal text-custom-h">${day}</p>
                                    </div>
                                    <div class="space-y-1 flex gap-4 md:gap-7 items-center flex-wrap">
                                        <label for="id_form-${index}-operating" class="inline-flex gap-4 items-center cursor-pointer">
                                            <span class=" text-sm font-medium text-gray-900 dark:text-gray-300">Closed</span>
                                            <input type="checkbox" onchange="toddleCheckboxes(event)" data-container="${day}_container" id="id_form-${index}-operating" name="form-${index}-operating" class="sr-only peer checkboxes" ${checked}>
                                            <div
                                                class="relative w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600">
                                            </div>
                                            <span class=" text-sm font-medium text-gray-900 dark:text-gray-300">Open</span>
                                        </label>
                                        <div id="${day}_container" class="max-w-[16rem] ${pointer_event} grid grid-cols-2 gap-4">
                                            <div>
                                                <label for="id_form-${index}-open_time" class="text-xs">Open time:</label>
                                                <div class="relative">

                                                    <input type="time" id="id_form-${index}-open_time" name="form-${index}-open_time"
                                                        class="bg-gray-50 border leading-none outline-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2  "
                                                         value="${hour.fields.open_time}" />
                                                </div>
                                            </div>
                                            <div>
                                                <label for="id_form-${index}-close_time" class="text-xs">Close time:</label>
                                                <div class="relative">

                                                    <input type="time" id="id_form-${index}-close_time" name="form-${index}-close_time"
                                                        class="bg-gray-50 border outline-none leading-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2  "
                                                         value="${hour.fields.close_time}" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                        `;
                    });

                } else {
                    let hours = data;
                }
            },
            error: function (error) {
                alert("Something went wrong");
            },
        });
    }
    window.onload = () => {
        get_hours()
    }
</script>
{% endif %}
<script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA1vMyd0KzU7mTn_AkMW3zd2V4cJC9w31I&libraries=places&callback=initMap&solution_channel=GMP_QB_addressselection_v1_cAC"
    async defer onerror="mapApiErrorHandler"></script>
{% endblock js %}