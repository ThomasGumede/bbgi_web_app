{% extends '_base.html' %}
{% load static %}


{% block seo_tags %}
<title>{{listing.title}}</title>
<meta name="description" content="{{listing.details|truncatechars:157}}">
<meta name="title" content="{{listing.title}}" />
<!-- Open Graph / Facebook -->
<meta property="og:type" content="website" />
<meta property="og:url" content="https://bbgi.co.za/listings/add" />
<meta property="og:title" content="{{listing.title}}" />
<meta property="og:description" content="{{listing.details|truncatechars:157}}" />
{% if listing.background_image %}
<meta property="og:image" content="https://bbgi.co.za{{listing.background_image.url}}" />
{% else %}
<meta property="og:image" content="https://bbgi.co.za{% static 'imgs/logo/logo.jpeg' %}" />
{% endif %}
<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:url" content="https://bbgi.co.za/listings/add" />
<meta property="twitter:title" content="{{listing.title}}" />
<meta property="twitter:description" content="{{listing.details|truncatechars:157}}" />
{% if listing.background_image %}
<meta property="twitter:image" content="https://bbgi.co.za{{listing.background_image.url}}" />
{% else %}
<meta property="twitter:image" content="https://bbgi.co.za{% static 'imgs/logo/logo.jpeg' %}" />
{% endif %}
{% endblock seo_tags %}

{% block content %}
<section class="w-full font-sans relative block bg-custom-h mt-10 mb-20">
    <div class="group overflow-hidden relative">
        <div class="w-full h-full absolute top-0 left-0 bg-custom-h z-50 opacity-50"></div>
        <div class="relative overflow-hidden block">
            <div class="img_box overflow-hidden relative block">
                <div
                    class="overflow-hidden h-[600px] md:h-[560px] bg-custom-h relative block transition-all duration-500 ease-in">
                    {% if listing.background_image %}
                    <img src="{{listing.background_image.url}}"
                        alt="{{listing.title}} background_image by {{listing.owner.get_full_name}}"
                        class="absolute top-1/2 left-1/2 h-full -translate-x-1/2 -translate-y-1/2 w-full transition-all duration-500 ease-in group-hover:scale-105 opacity-50 object-cover">
                    {% else %}
                    <img src="{% static 'imgs/no-image.png' %}" alt="{{listing.title}}"
                        class="absolute top-1/2 left-1/2 h-full -translate-x-1/2 -translate-y-1/2 w-full transition-all duration-500 ease-in group-hover:scale-105 opacity-50 object-cover">
                    {% endif %}
                </div>
                <div class="absolute  z-50 w-full h-fit md:w-8/12 top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2">
                    <div class="w-full h-full px-4">
                        <div class="flex items-center w-full flex-wrap gap-4 justify-between">
                            <div class="space-y-1 ">
                                <div class="w-20 h-20 md:h-36 md:w-36 rounded-lg relative overflow-hidden">
                                    {% if listing.logo %}
                                    <img src="{{listing.logo.url}}"
                                        alt="{{listing.title}} logo by {{listing.owner.get_full_name}}"
                                        class="absolute top-1/2 left-1/2 h-full -translate-x-1/2 -translate-y-1/2 w-full transition-all duration-500 ease-in object-cover">
                                    {% else %}
                                    <img src="{% static 'imgs/no-image.png' %}" alt="{{listing.title}}"
                                        class="absolute top-1/2 left-1/2 h-full -translate-x-1/2 -translate-y-1/2 w-full transition-all duration-500 ease-in object-cover">
                                    {% endif %}
                                </div>
                                <div class="text-white w-fit">
                                    <h1 class="text-xl md:text-3xl font-bold">{{listing.title}}</h1>
                                    <p class="text-xs md:text-base">{{listing.slogan}}</p>
                                    <div class="py-2 space-y-1">
                                        <div class="relative flex items-center">
                                            <div class="text-sm text-custom-primary">
                                                <i class="fa-solid fa-location-dot fa-lg font-bold"></i>
                                            </div>
                                            <div class="ml-2">
                                                <p class="text-sm font-normal">{{listing.get_full_location}}</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center w-full space-x-5">
                                            <div class="relative flex items-center">
                                                <div class="text-sm text-custom-primary">
                                                    <i class="fa-regular fa-star fa-lg font-bold"></i>
                                                </div>
                                                <div class="ml-2">
                                                    <p class="text-sm font-normal">{{listing.get_average_rating|safe}}</p>
                                                </div>
                                            </div>
                                            <div class="relative flex items-center">
                                                <div class="text-sm text-custom-primary">
                                                    <i class="fa-regular fa-comments fa-lg font-bold"></i>
                                                </div>
                                                <div class="ml-2">
                                                    <p class="text-sm font-normal"><span>{{listing.reviews.count}} Reviews</span></p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class=" cursor-pointer rounded-md  text-center text-white py-2 md:py-3">
                                            <div class="flex items-center w-fit justify-between flex-wrap gap-4">
                                                <span class="text-lg  font-bold text-white">Share: </span>
                                        
                                        
                                                <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}"
                                                    class="relative text-custom-primary text-sm h-8 w-8 rounded-full grid items-center justify-center font-bold ">
                                                    <i class="fa-brands fa-lg fa-facebook"></i>
                                                </a>
                                                <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text={{ listing.title }}"
                                                    class="relative text-custom-primary text-sm h-8 w-8 rounded-full grid items-center justify-center font-bold ">
                                                    <i class="fa-brands fa-lg fa-twitter"></i>
                                                </a>
                                                <a href="https://wa.me/?text={{ listing.title }}%20{{ request.build_absolute_uri }}"
                                                    class="relative text-custom-primary text-sm h-8 w-8 rounded-full grid items-center justify-center font-bold ">
                                                    <i class="fa-brands fa-lg fa-whatsapp"></i>
                                                </a>
                                                <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ request.build_absolute_uri }}&title={{ listing.title }}&summary={{listing.details|truncatechars:100}}"
                                                    class="relative text-custom-primary text-sm h-8 w-8 rounded-full grid items-center justify-center font-bold ">
                                                    <i class="fa-brands fa-lg fa-linkedin"></i>
                                                </a>
                                        
                                            </div>
                                        </div>
                                        
                                    </div>
                                    
                                </div>
                            </div>
                            <div class="block">
                                <div class="flex items-center md:gap-5 flex-wrap gap-4">
                                    
                                    
                                    {% if listing.owner == request.user %}
                                    <a href="{% url 'listings:update-listing' listing.id %}"
                                        class="border group hover:bg-custom-primary hover:border-custom-primary transition-colors duration-300 cursor-pointer border-white text-center text-white border-solid py-2 md:py-3 px-4 md:px-6">
                                        <div class="relative flex items-center">
                                            <div class="text-sm">
                                                <i class="fa-solid fa-plus fa-xl font-bold"></i>
                                            </div>
                                            <div class="ml-2">
                                                <p class="text-base font-regular">Edit</p>
                                            </div>
                                        </div>
                                    </a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>
<section class="relative font-sans w-full bg-custom-bg">
    <div class="px-6">
        <div class="flex flex-col lg:flex-row items-start -mx-4">
            <div class="w-full max-w-full px-4 flex-shrink-0 md:w-7/12 lg:w-8/12 h-full">
                <div class="w-full space-y-5 relative block">
                    <div class="border w-full p-2 lg:p-4">
                        <div class="w-fit mx-auto">
                            <div class="flex lg:items-center flex-wrap w-full gap-2 lg:gap-4">
                                <div data-category="full_description"
                                    class="bg-gray-300 cursor-pointer transition-all duration-500 py-2 lg:py-3 px-3 campaign_navbar lg:px-4 text-center text-gray-900 font-medium text-sm lg:text-xl">
                                    <p class="text-white">Description</p>
                                </div>
                                
                                <div data-category="reviews"
                                    class="bg-custom-primary cursor-pointer transition-all duration-500 py-2 lg:py-3 px-3 campaign_navbar lg:px-4 text-center text-white font-medium text-sm lg:text-xl">
                                    <p class="text-white">Reviews</p>
                                </div>
                                <div data-category="updates"
                                    class="bg-custom-primary cursor-pointer transition-all duration-500 py-2 lg:py-3 px-3 campaign_navbar lg:px-4 text-center text-white font-medium text-sm lg:text-xl">
                                    <p class="text-white">Gallery</p>
                                </div>
                                <div data-category="services"
                                    class="bg-custom-primary cursor-pointer transition-all duration-500 py-2 lg:py-3 px-3 campaign_navbar lg:px-4 text-center text-white font-medium text-sm lg:text-xl">
                                    <p class="text-white">Services</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="w-full p-4 relative block max-w-full overflow-hidden">
                        <div id="full_description"
                            class="w-12/12 relative block campaign_data transition-all duration-500">
                            <div class="relative block">
                                <div class="text-gray-800 font-normal text-base">{{listing.details|safe}}</div>
                            </div>
                            <div class="relative block mt-3 overflow-hidden space-y-2 p-[46px_30px_30px] bg-[#f2f7f7]">
                                <h3 class="text-lg mb-1 font-extrabold">Business Hours</h3>
                            
                                <ul class="space-y-4">
                                    {% for hour in listing.business_hours.all %}
                                    <li class="flex items-center justify-between">
                                        <p class="text-sm font-normal text-gray-500 duration-500 group-hover:text-custom-h">{{hour.get_day_display}}
                                        </p>
                                        {% if hour.operating %}
                                        <div class="gap-3 flex items-center">
                                            <p class="text-sm font-normal text-gray-500 duration-500 group-hover:text-custom-h">{{hour.open_time}}
                                            </p>
                                            <span class="text-sm font-normal text-gray-500">-</span>
                                            <p class="text-sm font-normal text-gray-500 duration-500 group-hover:text-custom-h">{{hour.close_time}}
                                            </p>
                                        </div>
                                        {% else %}
                                        <p class="text-sm font-normal text-red-500 duration-500 group-hover:text-custom-h">Closed</p>
                                        {% endif %}
                                    </li>
                                    {% endfor %}
                                </ul>
                            
                            
                            </div>
                        </div>
                        
                        <div id="reviews" class="w-full hidden campaign_data transition-all duration-500">
                            <div class="w-full space-y-7">

                                <div class="w-full space-y-7">
                                    <div class="w-full space-y-4  ">
                                        {% if listing.reviews.count > 0 %}
                                            {% for review in listing.reviews.all %}
                                                {% if review.comment %}
                                            
                                                    <article class="border border-solid p-4 rounded-lg w-full">
                                                        <div class="flex items-center mb-4">
                                                            {% if review.commenter == none %}
                                                            <img class="w-10 h-10 me-4 rounded-full" src="{% static 'imgs/no-image.png' %}" alt="{{review.commenter_full_names}}">
                                                            {% else %}
                                                                {% if review.commenter.profile_image %}
                                                                    <img class="w-10 h-10 me-4 rounded-full" src="{{review.commenter.profile_image.url}}" alt="{{review.commenter_full_names}}">
                                                                {% else %}
                                                                    <img class="w-10 h-10 me-4 rounded-full" src="{% static 'imgs/no-image.png' %}" alt="{{review.commenter_full_names}}">
                                                                {% endif %}
                                                            {% endif %}
                                                            <div class="font-medium text-custom-h">
                                                                <p>{{review.commenter_full_names}} </p>
                                                            </div>
                                                        </div>
                                                        <div class="flex items-center mb-1 space-x-1 rtl:space-x-reverse">
                                                            <svg class="w-4 h-4 {% if review.rating_value >= 1 %}text-yellow-300{% else %}text-gray-300{% endif %}" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                                viewBox="0 0 22 20">
                                                                <path
                                                                    d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                                                            </svg>
                                                            <svg class="w-4 h-4 {% if review.rating_value >= 2 %}text-yellow-300{% else %}text-gray-300{% endif %}" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                                viewBox="0 0 22 20">
                                                                <path
                                                                    d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                                                            </svg>
                                                            <svg class="w-4 h-4 {% if review.rating_value >= 3 %}text-yellow-300{% else %}text-gray-300{% endif %}" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                                viewBox="0 0 22 20">
                                                                <path
                                                                    d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                                                            </svg>
                                                            <svg class="w-4 h-4 {% if review.rating_value >= 4 %}text-yellow-300{% else %}text-gray-300{% endif %}" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                                viewBox="0 0 22 20">
                                                                <path
                                                                    d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                                                            </svg>
                                                            <svg class="w-4 h-4 {% if review.rating_value >= 5 %}text-yellow-300{% else %}text-gray-300{% endif %}" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                                                                fill="currentColor" viewBox="0 0 22 20">
                                                                <path
                                                                    d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                                                            </svg>
                                                            <h3 class="ms-2 text-sm font-semibold text-gray-900 dark:text-white">{{review.comment_title}}</h3>
                                                        </div>
                                                        <footer class="mb-5 text-sm text-gray-500 dark:text-gray-400">
                                                            <p>Reviewed on <time datetime="{{review.created}}">{{review.created}}</time></p>
                                                        </footer>
                                                        <p class="mb-2 text-gray-500 dark:text-gray-400">{{review.comment}}</p>
                                                        
                                                        
                                                        
                                                    </article>

                                                {% endif %}
                                            
                                            {% endfor %}
                                        {% else %}
                                            <div class="mx-auto w-full text-center">
                                                <p>There no reviews for this listing</p>
                                            </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div>
                                        <form action="{% url 'listings:get-listing' listing.slug %}" method="post">
                                            {% csrf_token %}
                                            <div class="grid items-start gap-7">
                                               <div class="w-full p-4 border border-solid  rounded-lg relative">
                                                    <h6 class="text-custom-h text-sm mt-3 mb-6 font-bold uppercase">
                                                        Add Review
                                                    </h6>
                                                    <div class="w-fit mx-auto text-center md:px-4 my-5 space-y-3">
                                                        <p class="text-custom-h font-medium">
                                                            How would you rate this business?*
                                                        </p>
                                                        {% if form.rating_value.errors %}
                                                        <span class="text-[11px] text-red-500 block font-normal lowercase">{{form.rating_value.errors.as_text}}</span>
                                                        {% endif %}
                                                        
                                                        <!-- Rating -->
                                                        <div class="flex w-fit mx-auto items-center">
                                                            <div class="flex space-x-1" id="star-rating">
                                                                <svg class="w-6 h-6 text-gray-300 hover:text-custom-primary cursor-pointer" fill="currentColor"
                                                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-value="1">
                                                                    <path
                                                                        d="M9.049 2.927a1 1 0 011.902 0l1.616 4.95a1 1 0 00.95.69h5.174a1 1 0 01.593 1.809l-4.187 3.048a1 1 0 00-.364 1.118l1.617 4.95a1 1 0 01-1.541 1.118l-4.186-3.048a1 1 0 00-1.176 0l-4.186 3.048a1 1 0 01-1.541-1.118l1.617-4.95a1 1 0 00-.364-1.118L2.3 10.376a1 1 0 01.593-1.809h5.174a1 1 0 00.95-.69l1.616-4.95z">
                                                                    </path>
                                                                </svg>
                                                                <svg class="w-6 h-6 text-gray-300 hover:text-custom-primary cursor-pointer" fill="currentColor"
                                                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-value="2">
                                                                    <path
                                                                        d="M9.049 2.927a1 1 0 011.902 0l1.616 4.95a1 1 0 00.95.69h5.174a1 1 0 01.593 1.809l-4.187 3.048a1 1 0 00-.364 1.118l1.617 4.95a1 1 0 01-1.541 1.118l-4.186-3.048a1 1 0 00-1.176 0l-4.186 3.048a1 1 0 01-1.541-1.118l1.617-4.95a1 1 0 00-.364-1.118L2.3 10.376a1 1 0 01.593-1.809h5.174a1 1 0 00.95-.69l1.616-4.95z">
                                                                    </path>
                                                                </svg>
                                                                <svg class="w-6 h-6 text-gray-300 hover:text-custom-primary cursor-pointer" fill="currentColor"
                                                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-value="3">
                                                                    <path
                                                                        d="M9.049 2.927a1 1 0 011.902 0l1.616 4.95a1 1 0 00.95.69h5.174a1 1 0 01.593 1.809l-4.187 3.048a1 1 0 00-.364 1.118l1.617 4.95a1 1 0 01-1.541 1.118l-4.186-3.048a1 1 0 00-1.176 0l-4.186 3.048a1 1 0 01-1.541-1.118l1.617-4.95a1 1 0 00-.364-1.118L2.3 10.376a1 1 0 01.593-1.809h5.174a1 1 0 00.95-.69l1.616-4.95z">
                                                                    </path>
                                                                </svg>
                                                                <svg class="w-6 h-6 text-gray-300 hover:text-custom-primary cursor-pointer" fill="currentColor"
                                                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-value="4">
                                                                    <path
                                                                        d="M9.049 2.927a1 1 0 011.902 0l1.616 4.95a1 1 0 00.95.69h5.174a1 1 0 01.593 1.809l-4.187 3.048a1 1 0 00-.364 1.118l1.617 4.95a1 1 0 01-1.541 1.118l-4.186-3.048a1 1 0 00-1.176 0l-4.186 3.048a1 1 0 01-1.541-1.118l1.617-4.95a1 1 0 00-.364-1.118L2.3 10.376a1 1 0 01.593-1.809h5.174a1 1 0 00.95-.69l1.616-4.95z">
                                                                    </path>
                                                                </svg>
                                                                <svg class="w-6 h-6 text-gray-300 hover:text-custom-primary cursor-pointer" fill="currentColor"
                                                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-value="5">
                                                                    <path
                                                                        d="M9.049 2.927a1 1 0 011.902 0l1.616 4.95a1 1 0 00.95.69h5.174a1 1 0 01.593 1.809l-4.187 3.048a1 1 0 00-.364 1.118l1.617 4.95a1 1 0 01-1.541 1.118l-4.186-3.048a1 1 0 00-1.176 0l-4.186 3.048a1 1 0 01-1.541-1.118l1.617-4.95a1 1 0 00-.364-1.118L2.3 10.376a1 1 0 01.593-1.809h5.174a1 1 0 00.95-.69l1.616-4.95z">
                                                                    </path>
                                                                </svg>
                                                            </div>
                                                            {{form.rating_value}}
                                                        </div>
                                                        <p id="review-text" class="text-custom-h font-medium text-xl">
                                                            
                                                        </p>
                                                        
                                                    
                                                        <!-- End Rating -->
                                                    </div>
                                                    <div class="flex flex-wrap space-y-3 md:space-y-0">
                                                        

                                                        <div class="w-full lg:w-6/12 md:px-4">
                                                            <div class="relative w-full mb-3">
                                                                <label for="id_facebook">
                                                                    Full Names
                                                                </label>
                                                
                                                                <input id="id_commenter_full_names" name="commenter_full_names" type="text"
                                                                    value="{% if request.user.is_authenticated %}{{request.user.get_full_name}}{% endif %}"
                                                                    class="block p-3 md:text-base w-full text-sm text-gray-900 outline-none bg-gray-50 rounded-lg border border-gray-300 focus:ring-custom-primary placeholder:text-gray-400 focus:border-custom-primary ease-linear transition-all duration-150">
                                                                <span
                                                                    class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.facebook.help_text}}</span>
                                                
                                                            </div>
                                                        </div>
                                                        <div class="w-full lg:w-6/12 md:px-4">
                                                            <div class="relative w-full mb-3">
                                                                <label for="id_commenter_email">
                                                                    Email
                                                                </label>
                                                                <input id="id_commenter_email" name="commenter_email" type="email"
                                                                    value="{% if request.user.is_authenticated %}{{request.user.email}}{% endif %}"
                                                                    class="block p-3 md:text-base w-full text-sm text-gray-900 outline-none bg-gray-50 rounded-lg border border-gray-300 focus:ring-custom-primary placeholder:text-gray-400 focus:border-custom-primary ease-linear transition-all duration-150">
                                                                <span
                                                                    class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.commenter_email.help_text}}</span>
                                                
                                                            </div>
                                                        </div>
                                                        <div class="w-full lg:w-12/12 md:px-4">
                                                            <div class="relative w-full mb-3">
                                                                <label for="id_comment_title">
                                                                    Title*
                                                                </label>
                                                        
                                                                <input id="id_comment_title" name="comment_title" type="text"
                                                                    value="" placeholder="E.g Excellent Customer Service" required
                                                                    class="block p-3 md:text-base w-full text-sm text-gray-900 outline-none bg-gray-50 rounded-lg border border-gray-300 focus:ring-custom-primary placeholder:text-gray-400 focus:border-custom-primary ease-linear transition-all duration-150">
                                                                <span class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.comment_title.help_text}}</span>
                                                                {% if form.comment_title.errors %}
                                                                <span class="text-[11px] text-red-500 block font-normal lowercase">{{form.comment_title.errors.as_text}}</span>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                        <div class="w-full px-4">
                                                            <div class="relative w-full mb-3">
                                                                <label for="id_comment">
                                                                    Review*
                                                                </label>
                                                        
                                                                <textarea name="comment" id="id_comment" required class="block p-3 md:text-base w-full text-sm text-custom-h outline-none placeholder:text-gray-400 bg-gray-50 rounded-lg border border-gray-300 focus:ring-custom-primary focus:border-custom-primary ease-linear transition-all duration-150" cols="30" rows="10"></textarea>
                                                                    <span class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.comment.help_text}}</span>
                                                                {% if form.comment.errors %}
                                                                    <span class="text-[11px] text-red-500 block font-normal lowercase">{{form.comment.errors.as_text}}</span>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                        
                                                
                                                    </div>
                                                    <hr class="mt-6 border-b-1 border-blueGray-300">
                                                    
                                                    <div class="mt-3">
                                                        <div class="text-center inline-block h-12 bg-custom-primary w-[150px] rounded-md cursor-pointer">
                                                            <input type="submit" value="submit" class="text-white w-full h-full cursor-pointer text-sm font-semibold" />
                                                        </div>
                                                    </div>
                                                </div> 
                                            </div>
                                            
                                        </form>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <div id="updates" class="w-full hidden campaign_data transition-all duration-500">
                            <div class="w-full relative block mx-auto">
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 p-4">
                                    {% for content in listing.images.all %}
                                    <div class="group cursor-pointer relative">
                                        <img src="{{content.image.url}}"
                                            alt="{{listing.title}}"
                                            class="w-full h-48 object-cover rounded-lg transition-transform transform scale-100 group-hover:scale-105" />
                                        <div
                                            class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                            <a href="{{content.image.url}}" target="_blank" rel="noopener noreferrer" class="bg-white text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors">
                                                View
                                            </a>
                                        </div>
                                    </div>
                                    {% endfor %}
                                
                                    
                                </div>

                            </div>
                        </div>
                        <div id="services" class="w-full hidden campaign_data bg-custom-bg transition-all duration-500">
                            <div class="w-fit mx-auto">
                                <div class="w-full grid gap-8">
                                    {% for service in listing.services.all %}
                                    
                                    <!-- <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl">
                                        <div class="md:flex">
                                            <div class="md:shrink-0">
                                                {% if service.image %}
                                                <img class="h-48 w-full object-cover md:h-full md:w-48" src="{{service.image.url}}" alt="{{service.title}} Service">
                                                {% else %}
                                                <img class="h-48 w-full object-cover md:h-full md:w-48" src="{% static 'imgs/no-image.png' %}" alt="{{service.title}} Service">
                                                {% endif %}
                                            </div>
                                            <div class="p-8">
                                                <div class="uppercase tracking-wide text-sm text-indigo-500 font-semibold">Company retreats</div>
                                                <a href="#" class="block mt-1 text-lg leading-tight font-semibold text-custom-h  hover:underline">{{service.title}}
                                                </a>
                                                <p class="mt-2 text-slate-500">{{service.description}}
                                                </p>
                                                <div class="flex mt-2 items-center w-full justify-between gap-4">
                                                    <span class="font-medium text-base">{{service.price_decription}} : R{{service.price}}</span>
                                                    <a href="{% url 'markets:create-quotation' service.id %}" class="bg-custom-h  text-white font-bold py-2 px-4 rounded">
                                                        Request Quote
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->
                                    
                                    
                                        <div class="m-4 mx-auto max-w-screen-lg rounded-md border border-gray-100 text-custom-text shadow-md">
                                            <div class="relative flex h-full flex-col text-custom-text md:flex-row">
                                                <div class="relative p-8 md:w-4/6">
                                                    <div class="flex flex-col md:flex-row">
                                                        <h2 class="mb-2 text-2xl font-black">{{service.title}}</h2>
                                                        <!-- <span class="ml-2 text-xs uppercase">Tailwind</span> -->
                                                    </div>
                                                    <p class="mt-3 font-sans text-base tracking-normal">{{service.description}}</p>
                                                    <div class="flex flex-col md:flex-row md:items-end">
                                                        <p class="mt-6 text-xl font-black">R{{service.price}}<sup class="align-super text-sm">00</sup></p>
                                                        <span class="ml-2 text-xs uppercase">{{service.price_decription}}</span>
                                                    </div>
                                                    <div class="mt-8">
                                                        <a href="{% url 'markets:create-quotation' service.id %}">
                                                            <button
                                                                class="mr-2 mb-4 flex cursor-pointer items-center justify-center rounded-md bg-custom-h py-2 px-8 text-center text-white transition duration-150 ease-in-out hover:translate-y-1 hover:bg-custom-primary">
                                                                
                                                                Request quote
                                                            </button>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div class="mx-auto flex items-center md:w-2/6 px-5 pt-1 md:p-8">
                                                    <img class="block h-auto  rounded-md shadow-lg" src="{% if service.image %}{{service.image.url}}{% else %}{% static 'imgs/no-image.png' %}{% endif %}"
                                                        alt="{{service.title}} cover image" />
                                                </div>
                                            </div>
                                        </div>
                                    
                                    
                                    
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="w-full max-w-full flex-shrink-0 px-4 md:w-5/12 lg:w-4/12">
                <div class="relative space-y-5">
                    <div class="relative block overflow-hidden p-[46px_30px_30px] bg-[#f2f7f7]">
                        <div class="space-y-5">
                            <h3 class="text-base md:text-lg font-bold">Listing Locations</h3>
                            {% for location in listing.business_locations.all %}
                            <div class="text-sm text-gray-500 md:text-base font-medium flex items-center gap-4">
                                <span class="w-8 h-8 grid items-center justify-center rounded-full border border-solid"><i
                                        class="fa-solid fa-sm text-custom-primary fa-location-dot"></i></span>
                                <span>{{location.address}}</span>
                            </div>
                    
                            
                            {% endfor %}
                        </div>
                    </div>
                    
                    <div class="relative block overflow-hidden p-[46px_30px_30px] bg-[#f2f7f7]">
                        <div class="space-y-5">
                            <h3 class="text-base md:text-lg font-bold">Listing info</h3>
                            
                            <div class="text-sm text-gray-500 md:text-base font-medium flex items-center gap-4">
                                <span class="w-8 h-8 grid items-center justify-center rounded-full border border-solid"><i
                                        class="fa-solid fa-sm text-custom-primary fa-location-dot"></i></span> <span>{{listing.get_full_location}}</span>
                            </div>
                            
                            {% if listing.phone %}
                            <div class="text-sm text-gray-500 md:text-base font-medium flex items-center gap-4">
                                <span class="w-8 h-8 grid items-center justify-center rounded-full border border-solid"><i
                                        class="fa-solid fa-sm text-custom-primary fa-phone"></i></span> <span>{{listing.phone}}</span>
                            </div>
                            {% endif %}
                            {% if listing.email %}
                            <div class="text-sm text-gray-500 md:text-base font-medium flex items-center gap-4">
                                <span class="w-8 h-8 grid items-center justify-center rounded-full border border-solid"><i class="fa-solid fa-sm text-custom-primary fa-envelope"></i></span> <span>{{listing.email}}</span>
                            </div>
                            {% endif %}
                            {% if listing.website %}
                            <a  target="_blank" rel="noopener noreferrer" href="{{listing.website}}" class="text-sm text-gray-500 md:text-base font-medium flex items-center gap-4">
                                <span class="w-8 h-8 grid items-center justify-center rounded-full border border-solid"><i
                                        class="fa-solid fa-sm text-custom-primary fa-globe"></i></span> <span>{{listing.website}}</span>
                            </a>
                            {% endif %}
                            <div class="space-y-2">
                                <h4 class="text-lg font-bold text-black">Follow us</h4>
                                <div class="flex items-center w-full gap-5">
                                    {% if listing.facebook %}
                                    <div class="w-8 h-8 grid items-center justify-center rounded-full border border-solid">
                                        <a  target="_blank" rel="noopener noreferrer" href="{{listing.facebook}}"><i class="fa-brands fa-sm text-custom-primary fa-facebook"></i></a>
                                    </div>
                                    {% endif %}
                                    {% if listing.twitter %}
                                    <div class="w-8 h-8 grid items-center justify-center rounded-full border border-solid">
                                        <a  target="_blank" rel="noopener noreferrer" href="{{listing.twitter}}"><i class="fa-brands fa-sm text-custom-primary fa-twitter"></i></a>
                                    </div>
                                    {% endif %}
                                    {% if listing.instagram %}
                                    <div class="w-8 h-8 grid items-center justify-center rounded-full border border-solid">
                                        <a  target="_blank" rel="noopener noreferrer" href="{{listing.instagram}}"><i class="fa-brands fa-sm text-custom-primary fa-instagram"></i></a>
                                    </div>
                                    {% endif %}
                                    {% if listing.linkedin %}
                                    <div class="w-8 h-8 grid items-center justify-center rounded-full border border-solid">
                                        <a  target="_blank" rel="noopener noreferrer" href="{{listing.linkedin}}"><i class="fa-brands fa-sm text-custom-primary fa-linkedin"></i></a>
                                    </div>
                                    {% endif %}
                                
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    {% if listing.map_coordinates %}
                    <div class="relative block overflow-hidden h-[400px] bg-[#f2f7f7]">
                        <div class="w-full h-full" id="gmp-map">
                    
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock content %}

{% block js %}
<script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA1vMyd0KzU7mTn_AkMW3zd2V4cJC9w31I&libraries=places&callback=initMap&solution_channel=GMP_QB_addressselection_v1_cAC"
    async defer></script>
<script>


    function initMap() {
        // Retrieve the coordinates from the hidden input field on the previous page
        const coordinatesInput = '{{listing.map_coordinates}}';
        const coordinates = coordinatesInput.split(',');
        const latitude = parseFloat(coordinates[0]);
        const longitude = parseFloat(coordinates[1]);

        // Create a map centered on the stored coordinates
        const map = new google.maps.Map(document.getElementById('gmp-map'), {
            center: {lat: latitude, lng: longitude},
            zoom: 12,  // You can adjust the zoom level as needed
        });

        // Optionally, you can add a marker at the stored coordinates
        new google.maps.Marker({
            position: {lat: latitude, lng: longitude},
            map: map
        });
    }



</script>
<script>
    let navbarcampaign_toggler = document.querySelectorAll(".campaign_navbar");
    let campaign_data = document.querySelectorAll(".campaign_data")
    navbarcampaign_toggler.forEach(ele => {
        ele.addEventListener("click", (e) => {
            for (let i = 0; i < navbarcampaign_toggler.length; i++) {
                navbarcampaign_toggler[i].classList.remove("active");
                navbarcampaign_toggler[i].classList.remove("bg-gray-300");
                navbarcampaign_toggler[i].classList.remove("text-gray-900");
                navbarcampaign_toggler[i].classList.add("bg-custom-primary");
                navbarcampaign_toggler[i].classList.add("text-custom-h");

            }
            let dataAttrib = ele.getAttribute("data-category");


            loadData(dataAttrib);

            ele.classList.add("active");
            ele.classList.add("bg-gray-300");
            ele.classList.add("text-gray-900");
            ele.classList.remove("bg-custom-primary");
            ele.classList.remove("text-custom-h");
        })
    })

    function loadData(idAttrib) {
        let data = document.getElementById(idAttrib);
        for (let i = 0; i < campaign_data.length; i++) {
            if (campaign_data[i].classList.contains("block")) {
                campaign_data[i].classList.remove("block");
                campaign_data[i].classList.add("hidden");
            }

        }
        if (data.classList.contains("hidden")) {
            data.classList.remove("hidden");
            data.classList.add("block");
        }

    }

    const stars = document.querySelectorAll('#star-rating svg');
        const ratingValueInput = document.getElementById('id_rating_value');
        const review_text = document.getElementById('review-text');

        stars.forEach((star, index) => {
            star.addEventListener('click', () => {
                const rating = index + 1;
                ratingValueInput.value = rating;
                console.log(ratingValueInput.value)

                // Reset all stars
                stars.forEach((s, i) => {
                    if (i < rating) {
                        s.classList.remove('text-gray-300');
                        s.classList.add('text-custom-primary');
                    } else {
                        s.classList.remove('text-custom-primary');
                        s.classList.add('text-gray-300');
                    }
                });

                if (index === 0) {
                    review_text.textContent = "Bad! Never Again."
                }else if(index === 1){
                    review_text.textContent = "Not bad, needs improvement"
                } else if (index === 2) {
                    review_text.textContent = "It is okay."
                } else if (index === 3) {
                    review_text.textContent = "It's really good"
                } else if (index === 4) {
                    review_text.textContent = "Again? A big yes!"
                } else{
                    review_text.textContent = ""
                }
            });

            
        });

        stars.forEach((star, index) => {
                
                
                start.addEventListener('hover', () => {
                    if (index == 0) {
                        review_text.textContent = "Bad! Never Again."
                    }
                })
            });

</script>

{% endblock js %}